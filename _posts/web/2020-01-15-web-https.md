---
layout: post
title:  "HTTPS"
date:   2020-01-15 17:39:00
author: bghgu
categories: WEB
tags: [WEB]
---

#### HTTPS(HyperText Trasnfer Protocol over Secure Socket Layer)
* HTTP의 보안이 강화된 버전이다.
* HTTPS는 통신의 인증과 암호화를 위해 넷스케이프 커뮤니케이션즈 코퍼레이션이 개발했다.
* HTTPS는 소켓 통신에서 일반 텍스트를 이용하는 대신에, SSL이나 TLS 프로토콜을 통해 세션 데이터를 암호화한다.
* 따라서 데이터의 적절한 보호를 보장한다.
* HTTPS의 기본 포트는 443이다.
* 보호의 수준은 웹 브라우저에서의 구현 정확도와 서버 소프트웨어, 지원하는 암호화 알고리즘에 달려있다.
* 핵심은 공개키 암호화 방식이다.

#### HTTPS 통신 흐름
* 공개키 저장소라고 부르는 곳은 CA(Certification Authority)이다.
* CA는 민간기업이지만 아무나 운영할 수 없고 신뢰성이 검증된 기업만 CA를 운영할 수 있다.
1. 먼저 애플리케이션 서버(A)를 만드는 기업은 HTTPS를 적용하기 위해서 공개키와 개인키를 만든다.
2. 그 다음에 신뢰할 수 있는 CA 기업을 선택하고 그 기업에 내 공개키를 관리해달라고 계약하고 돈을 지불한다.
3. 계약을 완료한 CA 기업은 또 CA 기업만의 공개키와 개인키가 있다. CA 기업은 CA 기업의 이름과 A 서버위 공개키, 공개키 암호화 방법 등의 정보를 담은 인증서를 만들고, 해당 인증서를 CA 기업의 개인키로 암호화해서 A서버에게 제공한다.
4. A 서버는 암호화된 인증서를 갖게 되었다. 이제 A 서버는 A 서버의 공개키로 암호화된 HTTPS 요청이 아닌 요청이 오면 이 암호화된 인증서를 클라이언트에게 제공한다.
5. 이제 클라이언트 입장에서 A 서버로 요청한다. HTTPS 요청이 아니기 때문에 CA 기업이 A 서버의 정보를 CA 기업의 개인키로 암호화한 인증서를 받게 된다.
6. 세계적으로 신뢰할 수 있는 CA 기업의 공개키는 브라우저가 이미 알고 있다.
7. 브라우저가 CA 기업 리스트를 쭉 탐색하면서 인증서에 적혀있는 CA 기업 이름이 같으면 해당 CA 기업의 공개키를 이미 알고 있는 브라우저는 해독할 수 있다. 해독을 통해 A 서버의 공개키를 얻는다.
8. A 서버와 통신할 때는 A 서버의 공개키로 암호화해서 요청을 하게 된다.

#### SSL 인증 과정
1. `서버`는 `CA`에 `서버의 정보`와 `서버의 공개키`를 전달
2. `CA`는 검증을 거친 후 `사이트 정보와 공개키`를 `CA`의 `개인키`로 암호화하여 인증서를 반환
3. 클라이언트(브라우저)는 사전에 미리 `CA`의 공개키를 가지고 있다.
4. 클라이언트가 사이트(서버)에 접속을 요청
5. 서버는 클라이언트에게 `CA`의 인증서를 반환
6. 클라이언트는 `CA`의 공개키로 서버로부터 받은 `CA`의 인증서를 복호화(CA의 인증서는 `CA`의 개인키로 암호화되어 있어 `CA`의 공개키로 복호화가 가능하다.)
7. `CA`의 인증서를 복호화하면 `서버의 정보`와 `서버의 공개키` 획득, 복호화가 가능하다면 해당 서버는 신뢰있는 서버로 판단
8. `서버`의 공개키로 `클라이언트`의 `대칭키`를 암호화하여 전송
9. `서버`의 개인키로 `클라이언트`가 전송한 `대칭키` 복호화
10. `대칭키`를 이용하여 암호문을 주고 받는다.